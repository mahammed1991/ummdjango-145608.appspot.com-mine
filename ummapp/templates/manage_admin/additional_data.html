{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Admin Panel</title>

    <!-- Bootstrap -->
    <link href="{% static 'manage_admin/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'manage_admin/css/font-awesome.min.css' %}" rel="stylesheet">
    <link href="{% static 'manage_admin/css/style.css' %}" rel="stylesheet">
    <!--<link href="{% static 'manage_admin/css/jquery-ui.css' %}" rel="stylesheet">-->
    <link href="{% static 'manage_admin/css/datepicker.min.css' %}" rel="stylesheet">
    <link href="{% static 'manage_admin/css/formValidation.min.css' %}" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!--<style type="text/css">
    	.ui-datepicker-calendar,.ui-datepicker-month { display: none; }
    </style>-->
  </head>
  <body>
    <section class="top-white-bg">
		<div class="container">
			<div class="row">
				<div class="col-xs-4 col-md-6 col-sm-6">
					<a href="/umm/manage-admin/" class="logo"><img src="{% static 'manage_admin/images/logo.png' %}" alt=""></a>
				</div>
				<div class="col-xs-8 col-md-6 col-sm-6">
					<a href="{% url 'auth:logout' %}?next=/" class="logout  pull-right"><i class="fa fa-power-off" aria-hidden="true"></i></a>
				</div>
			</div>
		</div>
	</section>
	
	<section class="process-create">
	  	<div class="container">
			<div class="create-heading text-uppercase pull-left">
				<h1 data-processid="{{data.process_id}}">{{data.process_name}}</h1>
			</div>
			<div class="edit pull-right">
				<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
			</div>
			<div class="clearfix"></div>
			<div class="enabled">
				<div class="white-bg">
					<div class="red-bg clearfix">
						<div class="create-heading pull-left">
							<ul class="process-tab">
								<li><a href="#" data-subprocessid="{{data.sub_process_id}}" class="active">{{data.sub_process_name}}</a></li>
							</ul>
						</div>
						<div class="edit-white pull-right">
							<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
						</div>
					</div>

					<div class="padding-15">
						<script type="text/javascript"> tasks = []</script>
						<div class="program-type clearfix">
							<div class="create-heading pull-left">
								 <ul class="prgrm-tab">
								 {% for key, val in data.programs.iteritems %}
									<li><a href="#"  data-programtype-id="{{val.id}}" class="prg-type">{{key}}</a></li>
								 {% endfor %}

								 </ul>
						    </div>
							<div class="edit2 pull-right">
								<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
							</div>
						</div>	
						<table class="table table-style" id="program-tasks">
							  <!--<tr>
							  {% for key, val in data.programs.iteritems %}
								  <td><a href="#" class="active" id="{{task.task_id}}">{{task.task_name}}</a></td>
								{% endfor %}
							  </tr>-->
							   <!--<tr>
								  <td><a href="#">Basic Optimization (Existing Campaign)</a></td>
								  <td><a href="#">Export Optimization</a></td>
								  <td><a href="#">Optimize Existing True-View ADS Campaign</a></td>
							  </tr>
							   <tr>
								  <td><a href="#">Advanced Optimization (New Campaign)</a></td>
								  <td><a href="#">Shopping Campaign Optimization (New Campaign)</a></td>
								  <td><a href="#"></a></td>
							  </tr>-->
							</table>
						<div class="gray-bg">
							<div class="sub-text clearfix">
								<div class="create-heading pull-left">
								<h3>Table </h3>
								</div>
								<div class="edit2 pull-right">
									<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
									<a href="#"><i class="fa fa-plus-square-o" aria-hidden="true"></i></a>
								</div>
							</div>
							<div class="white-bg">
								<div class="padding-15">
									<a href="#"  class="tbl-btn" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Task Definition	</a>
									<a href="#" class="tbl-btn">Points	</a>
									<a href="#" class="tbl-btn">Adoption Level	</a>
									<a href="#" class="tbl-btn">Auto Adoption Status	</a>
									<a href="#" class="tbl-btn">Timeframe</a>
								</div>
							</div>
							<div class="sub-text clearfix">
								<div class="create-heading pull-left">
								<h3>Create Update</h3>
								</div>
								<div class="edit2 pull-right">
									<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
								</div>
							</div>
							<div class="sub-text clearfix">
								<div class="create-heading pull-left">
								<h3>Create Key Words </h3>
								</div>
								<div class="edit2 pull-right">
									<a href="#"><i class="fa fa-pencil-square-o" aria-hidden="true"></i></a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>	
		</div>
	  </section>
  
  	  <div class="modal-style" style="width:100%">
  		<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
		  <div class="modal-dialog" role="document" style="width: 80%;">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h4 class="modal-title">Table Heading</h4>
		      </div>
		      <div class="modal-body">
		        <form id="taskDataForm">
		          <input type="hidden" class="form-control" name='program_task' value='' >
		          <div class="form-group">
		            <input type="text" class="form-control" name="column_name" id="column-name" placeholder="Task Definition	">
		          </div>
		          <h4 class="modal-title margin-bottom-10px" >Table Text</h4>
		          <div class="form-group">
		            <textarea class="form-control" name="column_data" id="message-text"></textarea>
		          </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-primary"><i class="fa fa-trash-o" aria-hidden="true"></i></button>
			        <button type="submit" class="btn btn-primary">Save</button>
			      </div>
		        </form>
		      </div>
		      <!--<div class="modal-footer">
		        <button type="button" class="btn btn-primary"><i class="fa fa-trash-o" aria-hidden="true"></i></button>
		        <button type="button" class="btn btn-primary">Save</button>
		      </div>-->
		    </div>
		  </div>
		</div>	
	  </div>
  
  
  
   
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="{% static 'manage_admin/js/jquery.min.js' %}"></script>
    <script src="{% static 'manage_admin/js/bootstrap-datepicker.min.js' %}"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="{% static 'manage_admin/js/formValidation.min.js' %}"></script>
    <script src="{% static 'manage_admin/js/form_bootstrap.min.js' %}"></script>
    <script src="{% static 'manage_admin/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'ckeditor/ckeditor.js' %}"></script>
    <!--<script src="{% static 'manage_admin/js/jquery-ui.min.js' %}"></script>-->
	<script type="text/javascript">
	$(document).ready(function(){
	    CKEDITOR.replace('message-text');

	    $('.prg-type').click(function () {
	    	$('.prg-type').removeClass('active');
	    	$(this).addClass('active');
	    	updateTaskTypes($(this).attr('data-programtype-id'));
	    });

		$('.prg-task').on('click', function() {
	    	debugger
	    	$('.prg-task').removeClass('active');
	    	$(this).addClass('active');
	    });

    	function updateTaskTypes(program_type_id){
    		$('#program-tasks').html("")
    		$.ajax({
	            url: '/get-program-tasks/'+program_type_id,
	            type: 'GET',
	            success: function(data) {
	            	if (data['data']){
	            		td_html = ''
	            		for(var i=0;i<data['data'].length;i++){
	            			task_name = Object.keys(data['data'][i])[0]
	            			task_id = data['data'][i][task_name]
	            			if (i == 0){
	            				td_html += "<td><a href='#' class='prg-task active' data-programtype-id="+task_id +">" + task_name +"</a></td>"	            				
	            			}
	            			else{
	            				td_html += "<td><a href='#'  class='prg-task' data-programtype-id="+task_id +">" + task_name +"</a></td>"	            				
	            			}
	            		}
	            		$('#program-tasks').append('<tr>' + td_html + '</tr>')
	            	}
	            },
	            error: function(xhr, status, error) {
	                var err = eval("(" + xhr.responseText + ")");
	                alert(err.Message);
	                //alert("Something went wrong, please try after some time");
	            }
    		});	
    	}

		$('#exampleModal').on('shown.bs.modal', function(){
			$('input[name=program_task]').val($('.prg-task.active').attr('data-programtype-id'));
    		$("#cke_22").hide();
    		$("#cke_15").hide();
    		$("#cke_30").hide();
    		$("#cke_35").hide();
		});


    	if('.prg-type'){
    		$('.prg-type:first').addClass('active');
    	}
    	updateTaskTypes($('.prgrm-tab > li > a:eq(0)').attr("data-programtype-id"));


     $('#taskDataForm')
         .formValidation({
             framework: 'bootstrap',
             icon: {
                 valid: 'glyphicon glyphicon-ok',
                 invalid: 'glyphicon glyphicon-remove',
                 validating: 'glyphicon glyphicon-refresh'
             },
             fields: {
                 column_name: {
                     validators: {
                         notEmpty: {
                             message: 'The field is required'
                         },
                     }
                 },
                 column_data: {
                     validators: {
                         notEmpty: {
                             message: 'The field is required'
                         },
                     }
                 },
             }
         })
         .on('success.form.fv', function(e) {
             // Save the form data via an Ajax request
             e.preventDefault();
             var $form = $('#taskDataForm');
             /*
             $.ajax({
                 url: '/contentadmin/update/invoice/',
                 method: 'POST',
                 data: $form.serialize()
             }).success(function(response) {
                $('#update_save_invoice').removeClass('disabled'); // Disables visually
                $('#update_save_invoice').prop('disabled', false);
                location.reload();
              });*/

         });
    });	


	</script>
	</body>
	</html>